<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head.ejs'); %>
  <body>
    <%- include('../partials/nav.ejs'); %>
    <main class="page-container">
      <%- include('../partials/pageHeader.ejs'); %>
      <form class="crud-form" action="/meetings" method="POST">
        <%- include('../partials/forms/selectInput.ejs', {
          fieldName: "company",
          fieldLabel: "Company",
          fieldValue: String(locals.meeting?.company?._id||""),
          fieldOptions: companies.map(company=>{return {value: String(company._id), label: company.name}})
        })%>
        <%- include('../partials/forms/selectInput.ejs', {
          fieldName: "jobApp",
          fieldLabel: "Job Application",
          fieldValue: String(locals.meeting?.jobApp?._id||""),
          fieldOptions: jobApps.map(jobApp=>{return {value: String(jobApp._id), label: jobApp.title}})
        })%>
        <%- include('../partials/forms/textInput.ejs', {
          fieldName: "title",
          fieldLabel: "Title",
          fieldValue: locals.meeting?.title || ""
        }) %>

        <%- include('../partials/forms/selectInput.ejs', {
          fieldName: "state",
          fieldLabel: "State",
          fieldValue: locals.meeting?.state || "",
          fieldOptions: [
            {
              value: "Planned",
              label: "Planned"
            },
            {
              value: "Done",
              label: "Done"
            },
            {
              value: "Canceled",
              label: "Canceled"
            }
          ]
        })%>

        <%- include('../partials/forms/dateInput.ejs', {
          fieldName: "startAt",
          fieldLabel: "Start Date",
          fieldValue: locals.meeting?.startAt ? locals.meeting?.startAt.toISOString().slice(0,10) : new Date().toISOString().slice(0,10)
        }) %>

        <%- include('../partials/forms/dateInput.ejs', {
          fieldName: "endAt",
          fieldLabel: "End Date",
          fieldValue: locals.meeting?.endAt ? locals.meeting.endAt.toISOString().slice(0,10) : ""
        }) %>

        <%- include('../partials/forms/textInput.ejs', {
          fieldName: "description",
          fieldLabel: "Description",
          fieldValue: locals.meeting?.description || ""
        }) %>

        <%- include('../partials/forms/textInput.ejs', {
          fieldName: "notes",
          fieldLabel: "Notes",
          fieldValue: locals.meeting?.notes || ""
        }) %>

        <%- include('../partials/forms/textInput.ejs', {
          fieldName: "attendees",
          fieldLabel: "Attendees (comma separated)",
          fieldValue: locals.meeting?.attendees?.join(", ") || ""
        }) %>

        <%- include('../partials/forms/selectInput.ejs', {
          fieldName: "meetingType",
          fieldLabel: "Meeting Type",
          fieldValue: locals.meeting?.meetingType || "",
          fieldOptions: [
            { value: "Coffee Chat", label: "Coffee Chat" },
            { value: "Info Interview", label: "Info Interview" },
            { value: "Networking Event", label: "Networking Event" }
          ]
        })%>

        <div class="actions">
          <button type="submit">Save Meeting</button>
        </div>
      </form>
    </main>
  </body>
</html>
