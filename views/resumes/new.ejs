<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head.ejs'); %>

    <body>
        <%- include('../partials/nav.ejs'); %>

        <main class="page-container">
        <%- include('../partials/pageHeader.ejs'); %>

            <form class="crud-form" action="/resumes" method="POST">
                <%- include('../partials/forms/textInput.ejs', {
                    fieldName: "name",
                    fieldLabel: "Name",
                    fieldValue: formData.name,
                    required: true
                })%>

                <%- include('../partials/forms/textInput.ejs', {
                    fieldName: "link",
                    fieldLabel: "Link",
                    fieldValue: formData.link
                })%>

                <%- include('../partials/forms/textInput.ejs', {
                    fieldName: "notes",
                    fieldLabel: "Notes",
                    fieldValue: formData.notes
                })%>

                <div class="field">
                    <label for="summary">Objective Statement</label>
                    <textarea name="summary" id="summary"><%= formData.summary %></textarea>
                </div>

                <!-- Parent Resume Selection -->
                <% if (duplicateFrom) { %>
                    <div class="field">
                        <label>Forked from:</label>
                        <p style="margin: 0.5rem 0; font-weight: 500;"><%= duplicateFrom.name %></p>
                        <input type="hidden" name="parent" value="<%= duplicateFrom._id %>">
                    </div>
                <% } else if (allResumes && allResumes.length > 0) { %>
                    <div class="field">
                        <label for="parent">Parent Resume (optional)</label>
                        <select name="parent" id="parent">
                            <option value="">None (standalone resume)</option>
                            <% allResumes.forEach(resume => { %>
                                <option value="<%= resume._id %>"><%= resume.name %></option>
                            <% }) %>
                        </select>
                    </div>
                <% } %>

                <%- include('./experiencePartial.ejs', {companies, resume: formData}); %>
                <%- include('./educationPartial.ejs', {resume: formData}); %>
                <%- include('./projectsPartial.ejs', {resume: formData}); %>
                <%- include('./certificationsPartial.ejs', {resume: formData}); %>


                <div class="actions">
                    <button type="submit">Add Resume</button>
                </div>
            <%-include('repeatableFieldGroup.ejs') %>
            </form>


        </main>
    </body>
</html>